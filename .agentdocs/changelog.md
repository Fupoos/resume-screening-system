# 简历智能初筛系统 - 产品开发日志

## 版本历史

### v1.0.0 (2026-01-05)

**首次发布版本**

#### 新增功能

1. **邮箱监听模块**
   - 支持腾讯企业邮箱IMAP连接
   - 每5分钟自动检查新邮件
   - 自动下载PDF/DOCX格式简历附件
   - 已处理邮件自动移动至"已处理"文件夹

2. **简历解析模块**
   - PDF解析：PyMuPDF + pdfplumber双重保障
   - DOCX解析：python-docx
   - 信息提取：姓名、电话、邮箱、教育、工作经历、技能标签
   - 支持多种编码格式

3. **AI Agent评估**
   - 集成FastGPT Agent
   - HTTP重试机制（最多3次，指数退避）
   - Agent降级处理
   - 评分范围：0-100分

4. **筛选结果展示**
   - 列表展示候选人信息
   - 按状态筛选（PASS/REVIEW/REJECT/PENDING）
   - 显示Agent评分和技能标签

5. **仪表盘统计**
   - 概览统计：总数、通过数、待定数、拒绝数、通过率
   - 按城市统计
   - 按职位统计

6. **岗位管理**
   - 从Agent配置同步岗位到数据库
   - 支持7种预置岗位
   - 岗位CRUD操作

#### 技术栈

- **后端**: FastAPI + Python 3.11 + SQLAlchemy 2.0 + PostgreSQL 15
- **前端**: React + TypeScript + Ant Design + Vite
- **异步任务**: Celery + Redis
- **部署**: Docker + Docker Compose

#### 核心原则

- 所有评分必须通过外部Agent完成
- 只保留有PDF附件+正文内容的简历
- 邮箱授权码AES-256加密存储

---

## 数据变更记录

### 2026-01-05

**模型变更**：
- 删除 `match_score`、`rule_score`、`similarity_score` 等本地评分字段
- 统一使用 `agent_score` 字段

**数据库迁移**：
- 执行迁移：`20260105_update_screening_result_fields.py`

**数据清理**：
- 删除56份无效简历（无PDF或无正文）
- 修复37条记录的筛选状态
- 清理26个异常格式城市名

---

## 已知问题

### 待修复

1. **学历等级分类**
   - 部分简历的学历等级未正确分类
   - 需要优化 `university_classifier.py` 的匹配逻辑

2. **Celery Beat稳定性**
   - 定时任务偶发执行失败
   - 需要增加错误处理和监控

3. **前端性能**
   - 简历列表页加载较慢时需优化分页
   - 大量数据时表格渲染卡顿

---

## 计划功能

### 近期计划（1-2周）

- [ ] 用户认证与权限管理
- [ ] 邮箱配置管理界面
- [ ] 企业微信通知
- [ ] 简历导出功能

### 中期计划（1个月）

- [ ] 简历去重功能
- [ ] 批量评估功能
- [ ] 自定义评分规则
- [ ] 数据报表生成

### 长期计划（3个月）

- [ ] AI面试安排
- [ ] 候选人关系图谱
- [ ] 招聘漏斗分析
- [ ] 移动端适配

---

## 代码仓库

- **GitHub**: https://github.com/Fupoos/resume-screening-system
- **文档目录**: `.agentdocs/`

---

## 更新日志

### 2026-01-12

**新增功能：简历分类展示与人工审核**
- ✅ 后端API新增 `exclude_needs_review` 参数（默认true）- 自动排除无法解析的简历
- ✅ 后端API新增 `needs_review_only` 参数 - 只显示需要人工审核的简历
- ✅ 后端API新增 `PUT /api/v1/resumes/{id}` - 支持手动更新简历信息
- ✅ 创建"人工审核"页面 - 处理加密PDF/扫描件/图片简历
- ✅ 修改简历列表 - 现在显示所有可解析的简历（PDF + DOCX）
- ✅ 删除 DOCX 临时查看页面（功能已整合到主流程）
- ✅ 修复API参数互斥问题（`needs_review_only` 优先于 `exclude_needs_review`）

**功能说明：**
- 简历列表：显示 `raw_text > 100字符` 的可解析简历
- 人工审核：显示 `raw_text <= 100字符` 的需处理简历，支持手动编辑候选人信息

---

### 2026-01-05

- ✅ 移除本地评分逻辑，统一使用外部Agent评估
- ✅ 更新筛选结果字段为 `agent_score`
- ✅ 添加QS TOP 200国外大学数据库（150+所名校）
- ✅ 修复邮箱监听只保留有PDF+正文的简历
- ✅ 删除邮件正文简历处理逻辑
- ✅ 清理无效简历（56份）
- ✅ 修复城市名重复问题（26个异常格式）
- ✅ 更新文档（PRD、PDD、Changelog）

---

*文档版本: v1.1*
*创建日期: 2026-01-05*
*最后更新: 2026-01-12*
